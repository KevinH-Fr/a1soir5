
<%= form_with(model: article) do |form| %>
  <% if article.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(article.errors.count, "error") %> prohibited this article from being saved:</h2>
      <ul>
        <% article.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form.hidden_field(:commande_id, value: @commandeId) %>
  <%= form.hidden_field(:produit_id, value: @produitId) %>

   <% if @produitId.present? %> 

    <div class="bloc-entete-model card-body p-1">
      <div class="row p-0 m-0">
        <div class="col cadre-interieur">
          <%= render "selection_produit/produitLie" %> <br>
        </div>

        <div class="col cadre-interieur"> 

          <div data-controller="totalupdate">
          
            <%= form.hidden_field :prixlocation, name:'prixlocationInitial', value: @valPrixLocationInitial %> <br>
            <%= form.hidden_field :prixvente, name:'prixVenteInitial', value: @valPrixInitial %>

            <div class="input-group input-group-sm mb-2 justify-content-center">
              <%= form.label :type, class:"input-group-text bg-primary text-light label-sized" %>
           
              <%= form.select :locvente,  @typelocvente, {include_blank: true}, 
                { data: { action: "change->totalupdate#setInitialPrix", target: "totalupdate.locvente" },  
                  class:"form-control text-center input-sized" } %>

            </div>

            <div class="input-group input-group-sm mb-2 justify-content-center">
              <%= form.label :quantite, class:"input-group-text bg-primary text-light label-sized" %>
              <%= form.number_field :quantite, { data: { action: "change->totalupdate#updateTotal", target: "totalupdate.quantite" }, 
                    class:"form-control text-center input-sized" } %> <br>
            </div>

            <div class="input-group input-group-sm mb-2 justify-content-center">
              <%= form.label :prix, class:"input-group-text bg-secondary text-light label-sized" %>
              <%= form.number_field :prix, { data: { action: "change->totalupdate#updateTotal", target: "totalupdate.prix"  },  
                        class:"form-control text-center input-sized" } %> <br>
           
            <div class="input-group input-group-sm mb-2 justify-content-center">
              <%= form.label :total, class:"input-group-text bg-dark text-light label-sized" %>
              <%= form.number_field :total, { data: { action: "change->totalupdate#updateTotal", target: "totalupdate.total" }, 
                        class:"form-control bg-dark text-white text-center input-sized" } %>
            </div>
          
          </div>
        </div>
      </div>
    </div>

    <div class="text-center text-bottom p-2 me-3">
      <%= link_to 'Annuler', new_article_path(commandeId: @commandeId), class:"btn btn-outline-danger btn-sm" %>
      <%= form.submit "CrÃ©er", class: 'btn btn-sm btn-success' %>
      <%#= form.submit onclick: "this.form.submit();" %>
    </div>

  <% end %>

 <% end %>
